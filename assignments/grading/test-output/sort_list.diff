1,38c1,12
< CLASS
< TYPEID List
< INHERITS
< TYPEID IO
< '{'
< OBJECTID isNil
< '('
< ')'
< ':'
< TYPEID Bool
< '{'
< '{'
< OBJECTID abort
< '('
< ')'
< ';'
< BOOL_CONST true
< ';'
< '}'
< '}'
< ';'
< OBJECTID cons
< '('
< OBJECTID hd
< ':'
< TYPEID Int
< ')'
< ':'
< TYPEID Cons
< '{'
< '('
< LET
< OBJECTID new_cell
< ':'
< TYPEID Cons
< ASSIGN
< NEW
< TYPEID Cons
---
> )))#24 CLASS
> List#24 INHERITS
> IO{))isNil():Bool{{abort();#28 BOOL_CONST true
> ;}};cons(hd:#30 IN
> t):Cons{(#31 LET
> NEW
> _cell:Cons<-#31 NEW
> Cons#31 IN
> NEW
> _cell.#32 IN
> it(hd,self))};car():#41 IN
> t{{abort();#41 NEW
40,436c14,57
< OBJECTID new_cell
< '.'
< OBJECTID init
< '('
< OBJECTID hd
< ','
< OBJECTID self
< ')'
< ')'
< '}'
< ';'
< OBJECTID car
< '('
< ')'
< ':'
< TYPEID Int
< '{'
< '{'
< OBJECTID abort
< '('
< ')'
< ';'
< NEW
< TYPEID Int
< ';'
< '}'
< '}'
< ';'
< OBJECTID cdr
< '('
< ')'
< ':'
< TYPEID List
< '{'
< '{'
< OBJECTID abort
< '('
< ')'
< ';'
< NEW
< TYPEID List
< ';'
< '}'
< '}'
< ';'
< OBJECTID rev
< '('
< ')'
< ':'
< TYPEID List
< '{'
< OBJECTID cdr
< '('
< ')'
< '}'
< ';'
< OBJECTID sort
< '('
< ')'
< ':'
< TYPEID List
< '{'
< OBJECTID cdr
< '('
< ')'
< '}'
< ';'
< OBJECTID insert
< '('
< OBJECTID i
< ':'
< TYPEID Int
< ')'
< ':'
< TYPEID List
< '{'
< OBJECTID cdr
< '('
< ')'
< '}'
< ';'
< OBJECTID rcons
< '('
< OBJECTID i
< ':'
< TYPEID Int
< ')'
< ':'
< TYPEID List
< '{'
< OBJECTID cdr
< '('
< ')'
< '}'
< ';'
< OBJECTID print_list
< '('
< ')'
< ':'
< TYPEID Object
< '{'
< OBJECTID abort
< '('
< ')'
< '}'
< ';'
< '}'
< ';'
< CLASS
< TYPEID Cons
< INHERITS
< TYPEID List
< '{'
< OBJECTID xcar
< ':'
< TYPEID Int
< ';'
< OBJECTID xcdr
< ':'
< TYPEID List
< ';'
< OBJECTID isNil
< '('
< ')'
< ':'
< TYPEID Bool
< '{'
< BOOL_CONST false
< '}'
< ';'
< OBJECTID init
< '('
< OBJECTID hd
< ':'
< TYPEID Int
< ','
< OBJECTID tl
< ':'
< TYPEID List
< ')'
< ':'
< TYPEID Cons
< '{'
< '{'
< OBJECTID xcar
< ASSIGN
< OBJECTID hd
< ';'
< OBJECTID xcdr
< ASSIGN
< OBJECTID tl
< ';'
< OBJECTID self
< ';'
< '}'
< '}'
< ';'
< OBJECTID car
< '('
< ')'
< ':'
< TYPEID Int
< '{'
< OBJECTID xcar
< '}'
< ';'
< OBJECTID cdr
< '('
< ')'
< ':'
< TYPEID List
< '{'
< OBJECTID xcdr
< '}'
< ';'
< OBJECTID rev
< '('
< ')'
< ':'
< TYPEID List
< '{'
< '('
< OBJECTID xcdr
< '.'
< OBJECTID rev
< '('
< ')'
< ')'
< '.'
< OBJECTID rcons
< '('
< OBJECTID xcar
< ')'
< '}'
< ';'
< OBJECTID sort
< '('
< ')'
< ':'
< TYPEID List
< '{'
< '('
< OBJECTID xcdr
< '.'
< OBJECTID sort
< '('
< ')'
< ')'
< '.'
< OBJECTID insert
< '('
< OBJECTID xcar
< ')'
< '}'
< ';'
< OBJECTID insert
< '('
< OBJECTID i
< ':'
< TYPEID Int
< ')'
< ':'
< TYPEID List
< '{'
< IF
< OBJECTID i
< '<'
< OBJECTID xcar
< THEN
< '('
< NEW
< TYPEID Cons
< ')'
< '.'
< OBJECTID init
< '('
< OBJECTID i
< ','
< OBJECTID self
< ')'
< ELSE
< '('
< NEW
< TYPEID Cons
< ')'
< '.'
< OBJECTID init
< '('
< OBJECTID xcar
< ','
< OBJECTID xcdr
< '.'
< OBJECTID insert
< '('
< OBJECTID i
< ')'
< ')'
< FI
< '}'
< ';'
< OBJECTID rcons
< '('
< OBJECTID i
< ':'
< TYPEID Int
< ')'
< ':'
< TYPEID List
< '{'
< '('
< NEW
< TYPEID Cons
< ')'
< '.'
< OBJECTID init
< '('
< OBJECTID xcar
< ','
< OBJECTID xcdr
< '.'
< OBJECTID rcons
< '('
< OBJECTID i
< ')'
< ')'
< '}'
< ';'
< OBJECTID print_list
< '('
< ')'
< ':'
< TYPEID Object
< '{'
< '{'
< OBJECTID out_int
< '('
< OBJECTID xcar
< ')'
< ';'
< OBJECTID out_string
< '('
< STR_CONST "\n"
< ')'
< ';'
< OBJECTID xcdr
< '.'
< OBJECTID print_list
< '('
< ')'
< ';'
< '}'
< '}'
< ';'
< '}'
< ';'
< CLASS
< TYPEID Nil
< INHERITS
< TYPEID List
< '{'
< OBJECTID isNil
< '('
< ')'
< ':'
< TYPEID Bool
< '{'
< BOOL_CONST true
< '}'
< ';'
< OBJECTID rev
< '('
< ')'
< ':'
< TYPEID List
< '{'
< OBJECTID self
< '}'
< ';'
< OBJECTID sort
< '('
< ')'
< ':'
< TYPEID List
< '{'
< OBJECTID self
< '}'
< ';'
< OBJECTID insert
< '('
< OBJECTID i
< ':'
< TYPEID Int
< ')'
< ':'
< TYPEID List
< '{'
< OBJECTID rcons
< '('
< OBJECTID i
< ')'
< '}'
< ';'
< OBJECTID rcons
< '('
< OBJECTID i
< ':'
< TYPEID Int
< ')'
< ':'
< TYPEID List
< '{'
< '('
< NEW
< TYPEID Cons
< ')'
< '.'
< OBJECTID init
< '('
< OBJECTID i
< ','
< OBJECTID self
< ')'
< '}'
< ';'
< OBJECTID print_list
< '('
< ')'
< ':'
< TYPEID Object
< '{'
< BOOL_CONST true
< '}'
< ';'
< '}'
< ';'
< CLASS
< TYPEID Main
---
> t;}};cdr():List{{abort();#43 NEW
> List;}};rev():List{cdr()};sort():List{cdr()};#49 IN
> sert(i:#49 IN
> t):List{cdr()};rcons(i:#51 IN
> t):List{cdr()};pr#53 IN
> t_list():Object{abort()};};#56 CLASS
> Cons#56 INHERITS
> List{xcar:#57 IN
> t;xcdr:List;isNil():Bool{#62 BOOL_CONST false
> };#64 IN
> it(hd:#64 IN
> t,tl:List):Cons{{xcar<-hd;xcdr<-tl;self;}};car():#72 IN
> t{xcar};cdr():List{xcdr};rev():List{(xcdr.rev()).rcons(xcar)};sort():List{(xcdr.sort()).#78 IN
> sert(xcar)};#80 IN
> sert(i:#80 IN
> t):List{#81 IF
> i<xcar#81 THEN
> (#82 NEW
> Cons).#82 IN
> it(i,self)#83 ELSE
> (#84 NEW
> Cons).#84 IN
> it(xcar,xcdr.#84 IN
> sert(i))#85 FI
> };rcons(i:#89 IN
> t):List{(#89 NEW
> Cons).#89 IN
> it(xcar,xcdr.rcons(i))};pr#91 IN
> t_list():Object{{out_#93 IN
> t(xcar);out_str#94 IN
> g(#94 STR_CONST "\\n"
> );xcdr.pr#95 IN
> t_list();}};};#100 CLASS
> Nil#100 INHERITS
> List{isNil():Bool{#101 BOOL_CONST true
> };rev():List{self};sort():List{self};#107 IN
> sert(i:#107 IN
> t):List{rcons(i)};rcons(i:#109 IN
> t):List{(#109 NEW
> Cons).#109 IN
> it(i,self)};pr#111 IN
> t_list():Object{#111 BOOL_CONST true
> };};#116 CLASS
> Ma#116 IN
438,465c59,63
< TYPEID IO
< '{'
< OBJECTID l
< ':'
< TYPEID List
< ';'
< OBJECTID iota
< '('
< OBJECTID i
< ':'
< TYPEID Int
< ')'
< ':'
< TYPEID List
< '{'
< '{'
< OBJECTID l
< ASSIGN
< NEW
< TYPEID Nil
< ';'
< '('
< LET
< OBJECTID j
< ':'
< TYPEID Int
< ASSIGN
< INT_CONST 0
---
> IO{l:List;iota(i:#121 IN
> t):List{{l<-#123 NEW
> Nil;(#124 LET
> j:#124 IN
> t<-#124 INT_CONST 0
468,537c66,77
< OBJECTID j
< '<'
< OBJECTID i
< LOOP
< '{'
< OBJECTID l
< ASSIGN
< '('
< NEW
< TYPEID Cons
< ')'
< '.'
< OBJECTID init
< '('
< OBJECTID j
< ','
< OBJECTID l
< ')'
< ';'
< OBJECTID j
< ASSIGN
< OBJECTID j
< '+'
< INT_CONST 1
< ';'
< '}'
< POOL
< ')'
< ';'
< OBJECTID l
< ';'
< '}'
< '}'
< ';'
< OBJECTID main
< '('
< ')'
< ':'
< TYPEID Object
< '{'
< '{'
< OBJECTID out_string
< '('
< STR_CONST "How many numbers to sort?"
< ')'
< ';'
< OBJECTID iota
< '('
< OBJECTID in_int
< '('
< ')'
< ')'
< '.'
< OBJECTID rev
< '('
< ')'
< '.'
< OBJECTID sort
< '('
< ')'
< '.'
< OBJECTID print_list
< '('
< ')'
< ';'
< '}'
< '}'
< ';'
< '}'
< ';'
---
> j<i#126 LOOP
> {l<-(#128 NEW
> Cons).#128 IN
> it(j,l);j<-j+#129 INT_CONST 1
> ;}#131 POOL
> );l;}};ma#137 IN
> ():Object{{out_str#139 IN
> g(#139 STR_CONST "How many numbers to sort?"
> );iota(#140 IN
> _#140 IN
> t()).rev().sort().pr#140 IN
> t_list();}};};
\ No newline at end of file
