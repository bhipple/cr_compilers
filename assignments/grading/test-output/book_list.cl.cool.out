CLASS
Book#3 INHERITS
IO{title:Str#4 IN
g;author:Str#5 IN
g;#7 IN
itBook(title_p:Str#7 IN
g,author_p:Str#7 IN
g):Book{{title<-title_p;author<-author_p;self;}};pr#15 IN
t():Book{{out_str#17 IN
g(#17 STR_CONST "title:      "
).out_str#17 IN
g(title).out_str#17 IN
g(#17 STR_CONST "\\n"
);out_str#18 IN
g(#18 STR_CONST "author:     "
).out_str#18 IN
g(author).out_str#18 IN
g(#18 STR_CONST "\\n"
);self;}};};#24 CLASS
Article#24 INHERITS
Book{per_title:Str#25 IN
g;#27 IN
itArticle(title_p:Str#27 IN
g,author_p:Str#27 IN
g,per_title_p:Str#28 IN
g):Article{{#30 IN
itBook(title_p,author_p);per_title<-per_title_p;self;}};pr#36 IN
t():Book{{self@Book.pr#38 IN
t();out_str#39 IN
g(#39 STR_CONST "periodical:  "
).out_str#39 IN
g(per_title).out_str#39 IN
g(#39 STR_CONST "\\n"
);self;}};};#45 CLASS
BookList#45 INHERITS
IO{)isNil():Bool{{abort();#50 BOOL_CONST true
;}};cons(hd:Book):Cons{(#53 LET
NEW
_cell:Cons<-#53 NEW
Cons#53 IN
NEW
_cell.#54 IN
it(hd,self))};)car():Book{{abort();#62 NEW
Book;}};)cdr():BookList{{abort();#68 NEW
BookList;}};pr#70 IN
t_list():Object{abort()};};#73 CLASS
Cons#73 INHERITS
BookList{xcar:Book;xcdr:BookList;isNil():Bool{#79 BOOL_CONST false
};#81 IN
it(hd:Book,tl:BookList):Cons{{xcar<-hd;xcdr<-tl;self;}};car():Book{xcar};cdr():BookList{xcdr};pr#93 IN
t_list():Object{{#95 CASE
xcar.pr#95 IN
t()#95 OF
dummy:Book#96 DARROW
out_str#96 IN
g(#96 STR_CONST "- dynamic type was Book -\\n"
);dummy:Article#97 DARROW
out_str#97 IN
g(#97 STR_CONST "- dynamic type was Article -\\n"
);#98 ESAC
;xcdr.pr#99 IN
t_list();}};};#104 CLASS
Nil#104 INHERITS
BookList{isNil():Bool{#105 BOOL_CONST true
};pr#107 IN
t_list():Object{#107 BOOL_CONST true
};};#111 CLASS
Ma#111 IN
{books:BookList;ma#115 IN
():Object{(#116 LET
a_book:Book<-(#117 NEW
Book).#117 IN
itBook(#117 STR_CONST "Compilers, Principles, Techniques, and Tools"
,#118 STR_CONST "Aho, Sethi, and Ullman"
)#119 IN
(#120 LET
an_article:Article<-(#121 NEW
Article).#121 IN
itArticle(#121 STR_CONST "The Top 100 CD_ROMs"
,#122 STR_CONST "Ulanoff"
,#123 STR_CONST "PC Magazine"
)#124 IN
{books<-(#126 NEW
Nil).cons(a_book).cons(an_article);books.pr#127 IN
t_list();}))};};